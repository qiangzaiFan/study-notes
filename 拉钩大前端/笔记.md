# JavaScript 深度剖析

## 函数式编程

### 为什么要学习函数式编程以及什么是函数式编程

#### 为什么要学习函数式编程？

- 函数式编程随着React的流星受到越来越多的关注
- Vue3也开始拥抱函数式编程
- 函数式编程可以抛弃this
- 打包过程中可以更好的利用tree shaking过滤无用代码
- 方便测试，方便并行处理
- 有很多库可以帮助我们进行函数式开发：lodash、underscore、ramda

#### 什么是函数式编程

函数式编程(Functional Programming, FP)是编程范式之一，我们常听说的编程范式还有面向过程编程、面向对象编程。

- 面向对象编程的思维方式：把现实世界中的事物抽象成程序世界中的类和对象，通过封装、继承和多态来演示事物事件的联系
- 函数式编程的思维方式：把现实世界的事物和事物之间的**联系**抽象到程序世界（对运算过程进行抽象）
- x->f(联系、映射)->y,y=f(x)
- **函数式编程中的函数指的不是程序中的函数（方法）**，而是数学中的函数即映射关系，例如：**y=sin(x)**,x和y的关系
- **相同的输入始终要得到相同的输出**（纯函数）
- 函数式编程用来描述数据（函数）之间的映射
- 函数式编程的一个好处就是可以让代码进行重用

- 



#### 函数是一等公民

- 函数可以存储在变量中

- 在JavaScript 中函数就是一个普通的对象（可以通过new Function()）,我们可以把函数存储到变量、数组中，它还可以作为另一个函数的参数和返回值，甚至我们可以在程序运行的时候通过new Function('alert(1)')来构造一个新的函数。

- 代码

  ```javascript
  // 把函数赋值给变量
  let fn = function () {
    console.log(Hello First-class Function);
  };
  fu();
  
  // 一个示例
  
  const BlogController = {
    index(posts){return Views.index(posts)},
    show(post){return Views.show(post)},
    create(attrs){return Db.create(attrs)},
    update(post,attrs){return Db.update(post,attrs)},
    destroy(post){return Db.destroy(post)},
  }
  
  // 优化
  // 一个函数包裹另一个函数，并且它的形式也相同的时候，可以优化，就是正常的简写
  const BlogController = {
    index:Views.index,
    show:Views.show,
    create:Db.create,
    update:Db.update,
    destroy:Db.destroy,
  }
  
  ```

  

- 函数是一等公民是我们后面要学习的高阶函数、柯里化等的基础。



#### 高阶函数

- 什么是高阶函数

  - 高阶函数（Higher-order function）

    - 可以把函数作为参数传递给另一个函数
    - 可以把函数作为另一个函数的返回结果
    - React中有一个概念，Higher-order-component,本质上就是高阶函数

  - 函数作为参数

    ```javascript
    // 高阶函数-函数作为参数
    function forEach(array, fn) {
      for (let index = 0; index < array.length; index++) {
        fn(array[index]);
      }
    }
    let numberList = [1, 3, 5, 6, 7, 8];
    // forEach(numberList, function (value) {
    //   console.log(value);
    // });
    
    function filter(array, fn) {
      let results = [];
      for (let index = 0; index < array.length; index++) {
        if (fn(array[index])) {
          results.push(array[index]);
        }
      }
      return results;
    }
    
    let res = filter(numberList, function (value) {
      return value % 2 === 0;
    });
    
    console.log(res);
    
    ```

    - 更加灵活了

  - 函数作为返回值

    - 代码

      ```javascript
      function makeFn() {
        let msg = "hello function";
        return function () {
          console.log(msg);
        };
      }
      // const fn = makeFn();
      // console.log(fn());
      
      // makeFn()();
      
      // jQuery中有一个once函数，Lodash中也有一个这个函数。目的是为了让函数只调用一次，使用场景例如：支付的时候，无论点击多少次，就只能调用一次。
      
      function once(fn) {
        let done = false;
        return function () {
          if (!done) {
            done = true;
            return fn.apply(this, arguments);
          }
        };
      }
      
      let pay = once(function (money) {
        console.log("---支付,", money + "元");
      });
      
      pay(4);
      
      ```

      

    - 

- 使用高阶函数的意义

  - 抽象可以帮助我们屏蔽细节，只需要关注与我们的目标
  - 高阶函数是用来抽象通用的问题
  - 
    - ![image-20220507085540681](%E7%AC%94%E8%AE%B0.assets/image-20220507085540681.png)
  - 

- 常见的高阶函数（比如 map、every、some）

  - ```javascript
    // map every some 高阶函数实现
    
    // map
    let arr = [1, 2, 3, 5, 7, 8];
    function map(array, fn) {
      let results = [];
      for (let item of array) {
        results.push(fn(item));
      }
      return results;
    }
    
    // console.log(map(arr, (v) => v * v));
    
    // every
    function every(array, fn) {
      let flag = false;
      for (let item of array) {
        flag = fn(item);
        if (!flag) {
          break;
        }
      }
      return flag;
    }
    // console.log(every(arr, (v) => v > 3));
    
    // some
    function some(array, fn) {
      let flag = false;
      for (let item of array) {
        flag = fn(item);
        if (flag) {
          break;
        }
      }
      return flag;
    }
    
    console.log(some(arr, (v) => v > 3));
    
    ```

  - 

- 



#### 







### 函数式编程的特性（纯函数、柯里化、函数组合等）

### 函数式编程的应用场景

### 函数式编程库 Lodash

## 

# 前端工程化实战

# Vue.js 框架源码与进阶

# React 框架原理与实战

# Node.js 全栈开发

# 泛客户端开发

# 商业技术解决方案与高阶技术

# 